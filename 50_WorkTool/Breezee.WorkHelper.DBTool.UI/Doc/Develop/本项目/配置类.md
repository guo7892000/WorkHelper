## 本项目-配置类
以文件形式保存的值列表，但又跟值列表不同的是，该文件只是保存同一类的数据，并且属性是可以自定义的！
### 多值列表配置类定义
```
/// <summary>
/// Java发布文件配置
/// </summary>
public class JavaPublishFileConfig
{
    public MoreKeyValueGroupConfig MoreXmlConfig { get; set; }
    public JavaPublishFileConfig(string sFileName)
    {
        var entity = new MoreKeyValueEntity();
        entity.DirectoryName = GlobalContext.PathData();
        entity.FileName = sFileName;
        // 键
        entity.ColKeys.Add(KeyString.Name);
        entity.ColKeys.Add(KeyString.CodeDir);
        entity.ColKeys.Add(KeyString.CopyToDir);
        entity.ColKeys.Add(KeyString.CopyCoverType);
        entity.ColKeys.Add(KeyString.ClassDir);
        entity.ColKeys.Add(KeyString.ExcludeRelateDir);
        entity.ColKeys.Add(KeyString.ExcludeRelateFile);
        // 值
        entity.ColVals.Add(ValueString.IsCopyFromSrc);
        entity.ColVals.Add(ValueString.RelCodeDir);
        entity.ColVals.Add(ValueString.RelClassDir);
        entity.ColVals.Add(ValueString.RelCopyToDir);
        MoreXmlConfig = new MoreKeyValueGroupConfig(entity);
    }

    /// <summary>
    /// 代码目录、class目录、复制到目录等配置
    /// </summary>
    public static class KeyString
    {
        public static readonly string Name = "Name";
        public static readonly string CodeDir = "CodeDir";
        public static readonly string CopyToDir = "CopyToDir";
        public static readonly string ClassDir = "ClassDir";
        public static readonly string CopyCoverType = "CopyCoverType";
        public static readonly string ExcludeRelateDir = "ExcludeRelateDir";
        public static readonly string ExcludeRelateFile = "ExcludeRelateFile";
    }

    /// <summary>
    /// 代码与class对应关系配置
    /// </summary>
    public static class ValueString
    {
        /// <summary>
        /// 是否从源码复制
        /// </summary>
        public static readonly string IsCopyFromSrc = "IsCopyFromSrc";
        public static readonly string RelCodeDir = "RelCodeDir";
        public static readonly string RelClassDir = "RelClassDir";
        public static readonly string RelCopyToDir = "RelCopyToDir";
    }

}
```

### WinForm使用配置类
```
#region 配置相关
/// <summary>
/// 配置选择变化
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void cbbTemplateType_SelectedIndexChanged(object sender, EventArgs e)
{
    if (string.IsNullOrEmpty(cbbTemplateType.Text.Trim()))
    {
        txbCodePath.Text = string.Empty;
        txbCopyToPath.Text = string.Empty;
        txbClassPath.Text = string.Empty;
        rtbExcludeRelateDir.Clear();
        rtbExcludeRelateFile.Clear();
        txbReplaceTemplateName.Text = string.Empty;

        DataTable dtCfg = dgvCodeClassRelConfig.GetBindingTable();
        if (dtCfg != null && dtCfg.Rows.Count > 0)

        {
            dtCfg.Clear();
        }
        tabControl1.SelectedTab = tpConfig;
        return;
    }

    if (cbbTemplateType.SelectedValue == null) return;
    string sTempType = cbbTemplateType.SelectedValue.ToString();
    txbReplaceTemplateName.Text = cbbTemplateType.Text;
    DataRow[] drArr = javaPublishFileConfig.MoreXmlConfig.KeyData.Select(sKeyId + "='" + sTempType + "'");
    if (drArr.Length > 0)
    {
        //代码目录
        txbCodePath.Text = drArr[0][JavaPublishFileConfig.KeyString.CodeDir].ToString();
        //class目录
        txbClassPath.Text = drArr[0][JavaPublishFileConfig.KeyString.ClassDir].ToString();
        //生成目录
        txbCopyToPath.Text = drArr[0][JavaPublishFileConfig.KeyString.CopyToDir].ToString();
        cbbCopyType.SelectedValue = drArr[0][JavaPublishFileConfig.KeyString.CopyCoverType].ToString();
        // 排除目录
        rtbExcludeRelateDir.Text = drArr[0][JavaPublishFileConfig.KeyString.ExcludeRelateDir].ToString();
        rtbExcludeRelateFile.Text = drArr[0][JavaPublishFileConfig.KeyString.ExcludeRelateFile].ToString();

        // 查询明细
        string sKeyId = javaPublishFileConfig.MoreXmlConfig.MoreKeyValue.KeyIdPropName;
        DataRow[] drArrConfg = javaPublishFileConfig.MoreXmlConfig.ValData.Select(sKeyId + "='" + sTempType + "'");
        DataTable dtConfig = dgvCodeClassRelConfig.GetBindingTable().Clone();
        int i = 1;
        foreach (DataRow dr in drArrConfg)
        {
            string sCodeDir = dr[JavaPublishFileConfig.ValueString.RelCodeDir].ToString();
            string sClassDir = dr[JavaPublishFileConfig.ValueString.RelClassDir].ToString();
            if(string.IsNullOrEmpty(sCodeDir))
            {
                continue;
            }

            DataRow drNew = dtConfig.NewRow();
            drNew[JavaPublishFileConfig.ValueString.IsCopyFromSrc] = dr[JavaPublishFileConfig.ValueString.IsCopyFromSrc];
            drNew[JavaPublishFileConfig.ValueString.RelCodeDir] = dr[JavaPublishFileConfig.ValueString.RelCodeDir];
            drNew[JavaPublishFileConfig.ValueString.RelClassDir] = dr[JavaPublishFileConfig.ValueString.RelClassDir];
            drNew[JavaPublishFileConfig.ValueString.RelCopyToDir] = dr[JavaPublishFileConfig.ValueString.RelCopyToDir];
            drNew["ROWNO"] = i;
            dtConfig.Rows.Add(drNew);
            i++;
        }
        dgvCodeClassRelConfig.BindDataGridView(dtConfig);
        dgvCodeClassRelConfig.AllowUserToAddRows = true;
        tabControl1.SelectedTab = ckbSelectConfig.Checked ? tpConfig : tpSource;
    }
}

/// <summary>
/// 保存配置
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void btnSaveReplaceTemplate_Click(object sender, EventArgs e)
{
    SaveCfg();
}

private bool SaveCfg(bool isShowConfirm = true)
{
    string sTempName = txbReplaceTemplateName.Text.Trim();
    string sLastSelectValue = (cbbTemplateType.SelectedValue == null || string.IsNullOrEmpty(cbbTemplateType.Text.Trim())) ? string.Empty : cbbTemplateType.SelectedValue.ToString();

    if (string.IsNullOrEmpty(sTempName))
    {
        ShowInfo("配置名称不能为空！");
        return false;
    }

    DataTable dtCodeClass = dgvCodeClassRelConfig.GetBindingTable();
    dtCodeClass.DeleteNullRow();
    if (dtCodeClass.Rows.Count == 0)
    {
        ShowInfo("请录入变化的代码文件相对【源代码目录】的相对路径！");
        return false;
    }

    if (isShowConfirm)
    {
        if (ShowOkCancel("确定要保存配置？") == DialogResult.Cancel) return false;
    }

    string sKeyId = javaPublishFileConfig.MoreXmlConfig.MoreKeyValue.KeyIdPropName;
    string sValId = javaPublishFileConfig.MoreXmlConfig.MoreKeyValue.ValIdPropName;
    DataTable dtKeyConfig = javaPublishFileConfig.MoreXmlConfig.KeyData;
    DataTable dtValConfig = javaPublishFileConfig.MoreXmlConfig.ValData;

    string sKeyIdNew = string.Empty;
    DataRow dr;
    bool isAdd = string.IsNullOrEmpty(cbbTemplateType.Text.Trim()) ? true : false;
    if (isAdd)
    {
        //新增
        sKeyIdNew = Guid.NewGuid().ToString();
        dr = dtKeyConfig.NewRow();
        dr[sKeyId] = sKeyIdNew;
                
        dtKeyConfig.Rows.Add(dr);
    }
    else
    {
        //修改
        string sKeyIDValue = cbbTemplateType.SelectedValue.ToString();
        sKeyIdNew = sKeyIDValue;
        DataRow[] drArrKey = dtKeyConfig.Select(sKeyId + "='" + sKeyIDValue + "'");
        DataRow[] drArrVal = dtValConfig.Select(sKeyId + "='" + sKeyIDValue + "'");
        if (drArrKey.Length == 0)
        {
            dr = dtKeyConfig.NewRow();
            dr[sKeyId] = sKeyIdNew;
            dtKeyConfig.Rows.Add(dr);
        }
        else
        {
            dr = drArrKey[0];
        }
        // 统一赋值
        dr[JavaPublishFileConfig.KeyString.Name] = sTempName;
        dr[JavaPublishFileConfig.KeyString.CodeDir] = txbCodePath.Text.Trim();
        dr[JavaPublishFileConfig.KeyString.ClassDir] = txbClassPath.Text.Trim();
        dr[JavaPublishFileConfig.KeyString.CopyToDir] = txbCopyToPath.Text.Trim();
        dr[JavaPublishFileConfig.KeyString.CopyCoverType] = cbbCopyType.SelectedValue.ToString();
        dr[JavaPublishFileConfig.KeyString.ExcludeRelateDir] = rtbExcludeRelateDir.Text.Trim().Replace("/","\\");
        dr[JavaPublishFileConfig.KeyString.ExcludeRelateFile] = rtbExcludeRelateFile.Text.Trim().Replace("/", "\\");

        if (drArrVal.Length > 0)
        {
            foreach (DataRow drOld in drArrVal)
            {
                dtValConfig.Rows.Remove(drOld);
            }
            dtValConfig.AcceptChanges();
        }
    }

    foreach (DataRow drCode in dtCodeClass.Rows)
    {
        DataRow drNew = dtValConfig.NewRow();
        drNew[sValId] = Guid.NewGuid().ToString();
        drNew[sKeyId] = sKeyIdNew;
        drNew[JavaPublishFileConfig.ValueString.IsCopyFromSrc] = drCode[JavaPublishFileConfig.ValueString.IsCopyFromSrc].ToString();
        drNew[JavaPublishFileConfig.ValueString.RelCodeDir] = drCode[JavaPublishFileConfig.ValueString.RelCodeDir].ToString();
        drNew[JavaPublishFileConfig.ValueString.RelClassDir] = drCode[JavaPublishFileConfig.ValueString.RelClassDir].ToString();
        drNew[JavaPublishFileConfig.ValueString.RelCopyToDir] = drCode[JavaPublishFileConfig.ValueString.RelCopyToDir].ToString();
        dtValConfig.Rows.Add(drNew);
    }
    javaPublishFileConfig.MoreXmlConfig.Save();
    //重新绑定下拉框
    cbbTemplateType.BindDropDownList(javaPublishFileConfig.MoreXmlConfig.KeyData, sKeyId, JavaPublishFileConfig.KeyString.Name, true, true);
    if (!string.IsNullOrEmpty(sLastSelectValue))
    {
        cbbTemplateType.SelectedValue = sLastSelectValue;
    }
    if (isShowConfirm)
    {
        ShowInfo("配置保存成功！"); 
    }
    return true;
}

private void btnRemoveTemplate_Click(object sender, EventArgs e)
{
    if (cbbTemplateType.SelectedValue == null)
    {
        ShowInfo("请选择一个配置！");
        return;
    }
    string sKeyIDValue = cbbTemplateType.SelectedValue.ToString();
    if (string.IsNullOrEmpty(sKeyIDValue) || string.IsNullOrEmpty(cbbTemplateType.Text.Trim()))
    {
        ShowInfo("请选择一个配置！");
        return;
    }

    if (ShowOkCancel("确定要删除该配置？") == DialogResult.Cancel) return;

    string sKeyId = javaPublishFileConfig.MoreXmlConfig.MoreKeyValue.KeyIdPropName;
    string sValId = javaPublishFileConfig.MoreXmlConfig.MoreKeyValue.ValIdPropName;
    DataTable dtKeyConfig = javaPublishFileConfig.MoreXmlConfig.KeyData;
    DataTable dtValConfig = javaPublishFileConfig.MoreXmlConfig.ValData;
    DataRow[] drArrKey = dtKeyConfig.Select(sKeyId + "='" + sKeyIDValue + "'");
    DataRow[] drArrVal = dtValConfig.Select(sKeyId + "='" + sKeyIDValue + "'");

    if (drArrVal.Length > 0)
    {
        foreach (DataRow dr in drArrVal)
        {
            dtValConfig.Rows.Remove(dr);
        }
        dtValConfig.AcceptChanges();
    }

    if (drArrKey.Length > 0)
    {
        foreach (DataRow dr in drArrKey)
        {
            dtKeyConfig.Rows.Remove(dr);
        }
        dtKeyConfig.AcceptChanges();
    }
    javaPublishFileConfig.MoreXmlConfig.Save();
    //重新绑定下拉框
    cbbTemplateType.BindDropDownList(javaPublishFileConfig.MoreXmlConfig.KeyData, sKeyId, JavaPublishFileConfig.KeyString.Name, true, true);
    ShowInfo("配置删除成功！");
} 
#endregion
```