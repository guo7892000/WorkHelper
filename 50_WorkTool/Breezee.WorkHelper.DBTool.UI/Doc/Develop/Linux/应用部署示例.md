## Linux 应用部署示例

### 应用部署到JBOSS中示例
1、备份：cp -r 源目录 备份目录  
2、移动压缩包到指定目录：mv -f 压缩包所在位置 目标目录  
3、进入目录：cd 目录  
4、解压压缩包并直接覆盖文件：unzip -o 压缩包路径  
5、进入JOBSS的BIN目录  
6、显示所有jboss进程：ps -ef|grep jboss  
7、终止进程：kill 进程号  
8、后台启动JBOSS：nohup ./standalone.sh -b 0.0.0.0 &  
9、查看后台启动日志记录：tail -f nohup.out  
```
cp -r /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/deployments/. /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/BF20251120/	
mv -f /tmp/TestBom.war.zip /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/deployments/		
cd /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/deployments		
unzip -o TestBom.war.zip		
cd /opt/application/appSrv/jboss-as-7.2.0.Final/bin		
ps -ef|grep jboss		
kill 1122		
nohup ./standalone.sh -b 0.0.0.0 &		
tail -f nohup.out		
```
### 其他常用命令：
```		
mv ./TestBom.war ./TestBom.war  :重命名
rm -rf TestBom.war	:删除文件
rm -rf ./temp/TestDir	:删除目录

```

### 自动化部署脚本
```
#!/bin/bash

set -e  # 遇到错误立即退出

echo "开始部署JFBom应用..."

# 1. 移动war包到部署目录
echo "步骤1: 移动war包到部署目录..."
mv -f /tmp/JFBom.war.zip /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/deployments/

# 2. 进入部署目录
echo "步骤2: 进入部署目录..."
cd /opt/application/appSrv/jboss-as-7.2.0.Final/standalone/deployments

# 3. 解压war包
echo "步骤3: 解压war包..."
unzip -o JFBom.war.zip

# 4. 进入JBoss bin目录
echo "步骤4: 进入JBoss bin目录..."
cd /opt/application/appSrv/jboss-as-7.2.0.Final/bin

# 5. 检查JBoss进程
echo "步骤5: 检查JBoss进程..."
ps -ef | grep jboss || echo "未找到运行的JBoss进程"

# 6. 停止现有JBoss进程（如果存在）
echo "步骤6: 停止JBoss进程..."
# 更安全的方式获取进程ID
JBOSS_PID=$(ps -ef | grep jboss | grep -v grep | awk '{print $2}' | head -1)

if [ -n "$JBOSS_PID" ]; then
    echo "正在停止JBoss进程: $JBOSS_PID"
    kill $JBOSS_PID
    sleep 5  # 等待进程停止
    
    # 检查进程是否已停止
    if ps -p $JBOSS_PID > /dev/null; then
        echo "进程仍在运行，强制杀死..."
        kill -9 $JBOSS_PID
    fi
else
    echo "未找到运行的JBoss进程"
fi

# 7. 启动JBoss
echo "步骤7: 启动JBoss服务..."
nohup ./standalone.sh -b 0.0.0.0 &

# 8. 等待启动并查看日志
echo "步骤8: 查看启动日志..."
sleep 3  # 等待日志文件创建
tail -f nohup.out &

# 等待一段时间后自动退出tail
TAIL_PID=$!
sleep 30  # 观察30秒日志
kill $TAIL_PID

echo "部署完成！应用正在启动中..."
echo "可以使用以下命令查看实时日志："
echo "tail -f /opt/application/appSrv/jboss-as-7.2.0.Final/bin/nohup.out"

```