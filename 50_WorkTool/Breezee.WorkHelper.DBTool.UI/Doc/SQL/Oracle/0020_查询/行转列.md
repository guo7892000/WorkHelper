### 行转列
```
/*行转列*/
WITH tempKPI AS (select TO_NUMBER(SUBSTR(KPI.YEAR_MONTH, -2)) AS MONTHS,
       KPI.PART_PZ_RATE /*备件品种满足率*/,
       KPI.NEED_VARIETY_ALL /*必备件品种满足率*/
 FROM T_PA_BU_PART_MONTH_KPI KPI
 WHERE KPI.NET_CODE= '#NET_CODE#'
 AND SUBSTR(KPI.YEAR_MONTH,0,4) = '#YYYY#'
 ) 
select '总体满足率(%)' ""CAL_TYPE"", 
sum(decode(months,1,PART_PZ_RATE,0)) ""1"",sum(decode(months,2,PART_PZ_RATE,0)) ""2"",sum(decode(months,3,PART_PZ_RATE,0)) ""3"",
sum(decode(months,4,PART_PZ_RATE,0)) ""4"",sum(decode(months,5,PART_PZ_RATE,0)) ""5"",sum(decode(months,6,PART_PZ_RATE,0)) ""6"",
sum(decode(months,7,PART_PZ_RATE,0)) ""7"",sum(decode(months,8,PART_PZ_RATE,0)) ""8"",sum(decode(months,9,PART_PZ_RATE,0)) ""9"",
sum(decode(months,10,PART_PZ_RATE,0)) ""10"",sum(decode(months,11,PART_PZ_RATE,0)) ""11"",sum(decode(months,12,PART_PZ_RATE,0)) ""12""
from tempKPI
union 
select '必备件品种满足率(%)' ""CAL_TYPE"", 
sum(decode(months,1,NEED_VARIETY_ALL,0)) ""1"",sum(decode(months,2,NEED_VARIETY_ALL,0)) ""2"",sum(decode(months,3,NEED_VARIETY_ALL,0)) ""3"",
sum(decode(months,4,NEED_VARIETY_ALL,0)) ""4"",sum(decode(months,5,NEED_VARIETY_ALL,0)) ""5"",sum(decode(months,6,NEED_VARIETY_ALL,0)) ""6"",
sum(decode(months,7,NEED_VARIETY_ALL,0)) ""7"",sum(decode(months,8,NEED_VARIETY_ALL,0)) ""8"",sum(decode(months,9,NEED_VARIETY_ALL,0)) ""9"",
sum(decode(months,10,NEED_VARIETY_ALL,0)) ""10"",sum(decode(months,11,NEED_VARIETY_ALL,0)) ""11"",sum(decode(months,12,NEED_VARIETY_ALL,0)) ""12""
from tempKPI;
```
### 列转行
-- 1.使用SYS.ODCIVARCHAR2LIST
```SELECT COLUMN_VALUE  FROM TABLE(SYS.ODCIVARCHAR2LIST('1','2','3','4','5'));  ```
(1)Table函数将数组里的内容通过SQL语句查询出来；  
(2)ODCIVARCHAR2LIST 在9I 及以上版本中均可使用。在9I中可通过创建TYPE，10G及以上直接使用SYS.ODCIVARCHAR2LIST；  
(3)ODCIVARCHAR2LIST 适用于字符集，不适用单个字符串，如果是单个字符串，可以通过参考2中(如下)方法实现。  
-- 2.其他方法实现列转行
-- (1) 利用CONNECT BY （使用9I，10G,11G）
```
WITH T AS (SELECT  '1,2,3,4,5' AS STR FROM DUAL)
SELECT  STR1  
FROM ( SELECT  DISTINCT
               SUBSTR(T.CA,INSTR(T.CA, ',', 1, C.LV) + 1,
                      INSTR(T.CA, ',', 1, C.LV + 1) -(INSTR(T.CA, ',', 1, C.LV) + 1)) AS STR1
      FROM (SELECT ',' || STR || ',' AS CA,LENGTH(STR || ',') -NVL(LENGTH(REPLACE(STR, ',')), 0) AS CNT FROM T) T,
           (SELECT LEVEL LV FROM DUAL CONNECT BY LEVEL <= 9) C
      WHERE C.LV <= T.CNT
      ORDER BY STR1);
```
--(2).正则表达式（使用10G及以上版本）
```
WITH TEST AS (SELECT  '1,2,3,4,5' AS STR FROM DUAL)
SELECT DISTINCT REGEXP_SUBSTR(STR, '[^,]+', 1, LEVEL)
FROM TEST
CONNECT BY ROWNUM <= 5;
```