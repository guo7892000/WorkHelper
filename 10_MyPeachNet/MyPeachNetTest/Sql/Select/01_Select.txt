SELECT DISTINCT A.[PROVINCE_ID] AS PROVINCE_ID
  ,A.[PROVINCE_CODE]
 ,B.[CITY_NAME]
 ,(SELECT TOP 1 ID FROM SUB T WHERE T.RID = A.RID AND A.NAME ='#NAME#' AND ( TFLG = '#TFLG#' OR ( CREATOR = '#CREATOR#' OR CREATOR_ID = #CREATOR_ID# ) )) AS ID
  ,A.[UPDATE_CONTROL_ID]
FROM TAB AS A
LEFT  OUTER JOIN BAB B on A.ID = B.ID AND A.NAME ='#NAME#' AND TO_CAHR(A.CDATE,'yyyy-MM-dd') ='#DATE#'
FULL JOIN BC C on C.ID = B.ID AND C.TNAME ='#TNAME#'
RIGHT  OUTER  JOIN (
    SELECT ID,PROVINCE_ID,UPDATE_CONTROL_ID,ID
    FROM TAB_C
    WHERE PROVINCE_ID = '#PROVINCE_ID#'
       AND UPDATE_CONTROL_ID= '#UPDATE_CONTROL_ID#'
) D on D.ID = B.ID AND D.TNAME ='#TNAME#'
WHERE PROVINCE_ID = '#PROVINCE_ID#'
	AND UPDATE_CONTROL_ID= '#UPDATE_CONTROL_ID#'
	OR REMARK LIKE '%#REMARK#'
	AND (MODIFIER IN ('#MDLIST:LS-4#') AND ( CREATOR = '#CREATOR#' OR CREATOR_ID = #CREATOR_ID# ) AND TFLG = '#TFLG#')
 AND TO_CHAR(TFLG,'yyyy') = '#TFLG2#'
AND TFLG =  TO_DATE('#TFLG#','yyyy-MM-dd')
	
AND EXISTS(SELECT 1 FROM TBF G WHERE G.ID = A.ID AND G.BF = '#BF#' )
GROUP BY 	PROVINCE_ID
HAVING A.SORT_ID > #SORT_ID:R#
ORDER BY A.[PROVINCE_CODE],B.[CITY_NAME]
LIMIT 100,#PAGE_SIZE#