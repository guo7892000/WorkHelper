## Maven总结
### 关于引入本地目录的外部包
一定要将所有jar包都由Maven的pom.xml进行管理！如要引入项目中指定目录下的jar包，可以使用以下方式：  
```
<dependency>						
    <groupId>org.open</groupId>						
    <artifactId>open-core</artifactId>						
    <version>1.5</version>						
    <scope>system</scope>						
    <systemPath>${basedir}/WebContent/WEB-INF/lib/open-core.jar</systemPath>						
</dependency>	

<dependency>
 <groupId>net.sf.json-lib</groupId>
 <artifactId>json-lib</artifactId>
 <version>2.3</version>
 <scope>system</scope>
 <systemPath>${project.basedir}/src/main/webapp/WEB-INF/lib/json-lib-2.3.jar</systemPath>
</dependency>

```

### 修改pom.xml并保存后生效问题：		
	还需要或击工程，然后Maven ==> Update Project… ==> 确认本工程为选中状态，点击OK即可。	
### Maven的配置文件pom.xml中定义版本属性，然后在依赖包中使用示例：
```	
<properties>	
	<spring-version>4.1.2.RELEASE</spring-version>	
	<log4j.version>1.2.17</log4j.version>	
</properties>	
		
<dependencies>	
	<dependency>	
	    <groupId>log4j</groupId>	
	    <artifactId>log4j</artifactId>	
	    <version>${log4j.version}</version>	
	</dependency>	
		
	<!-- SPRING JDBC -->	
	<dependency>	
	    <groupId>org.springframework</groupId>	
	    <artifactId>spring-jdbc</artifactId>	
	    <version>${spring-version}</version>	
	</dependency>	
		
	<dependency>	
	    <groupId>org.springframework</groupId>	
	    <artifactId>spring-webmvc</artifactId>	
	    <version>${spring-version}</version>	
	</dependency>	
</dependencies>	
```			
### spring-boot-maven-plugin报红，提示找不到		
需要加一个版本号
```	
	<plugins>	
	    <plugin>	
	        <groupId>org.springframework.boot</groupId>	
	        <artifactId>spring-boot-maven-plugin</artifactId>	
	        <version>2.2.2.RELEASE</version>	
	        <configuration>	
	            <fork>true</fork>	
	            <addResources>true</addResources>	
	        </configuration>	
	    </plugin>	
	</plugins>	
```
但是版本号不能随便加，需要和spring-boot-dependencies保持一致。  
```	
<dependency>	
	<groupId>org.springframework.boot</groupId>	
	<artifactId>spring-boot-dependencies</artifactId>	
	<version>2.2.2.RELEASE</version>	
	<type>pom</type>	
	<scope>import</scope>	
</dependency>
```	
或者我们可以到Maven中心仓库（https://mvnrepository.com/）去搜索【spring-boot-maven-plugin】，看哪个版本合适再加上去！	
		
### Java项目如何导入jar包		
方法1：从本地或远程依赖库引入（常用）	
如果是我们自己的Maven项目，可以先把jar包安装到本地库，再引用，这样能保证最新：	
先使用Maven命令清除、打包、安装命令将其安装到本地Maven库：	
`mvn clean package install`	
然后在其他工程中引入：	
```
<dependency>	
	<groupId>org.breezee</groupId>	
	<artifactId>mypeach</artifactId>	
	<version>1.0.1</version>	
</dependency>
```
不过一般公司也有一个依赖库，我们需要在Maven配置文件中配置公司依赖库，然后直接在项目中引用就好。一些开源的依赖库，我们一般在Maven中心库查找依赖并引入。	

### Maven pom文件中dependency scope用法
在Maven中依赖的域有： compile、provided、runtime、system、test、import。						
依赖范围(Scope)		编译classpath		测试classpath		运行时classpath
compile		Y		Y		Y
test		-		Y		-
provided	Y		Y		-
runtime		-		Y		Y
system		Y		Y		-
						
compile（默认）						
当依赖的scope为compile的时候，那么当前这个依赖的包，会在编译的时候被加入进来，并且在打包（mvn package）的时候也会被加入进来。						
编译范围有效，在编译与打包时都会加入进去。						
						
provided						
当依赖的scope为provided的时候，在编译和测试的时候有效，在执行（mvn package）进行打包时不会加入。比如， 我们开发一个web应用，在编译时我们需要依赖servlet-api.jar，但是在运行时我们不需要该 jar包，						
因为这个jar 包已由web服务器提供，如果在打包时又被加入进去，那么就可能产生冲突。此时我们就可以使用 provided 进行范围修饰。						
system						
与provided相同，不过被依赖项不会从maven仓库获取，而是从本地文件系统拿，需要配合systemPath属性使用。比如：
```
<dependency>						
    <groupId>org.open</groupId>						
    <artifactId>open-core</artifactId>						
    <version>1.5</version>						
    <scope>system</scope>						
    <systemPath>${basedir}/WebContent/WEB-INF/lib/open-core.jar</systemPath>						
</dependency>						
```						
runtime						
当依赖的scope为runtime的时候，在运行的时候才会依赖，在编译的时候不会依赖。比如，在编译的时候我们不需要JDBC API的jar包，而在运行的时候我们才需要JDBC驱动包。就可以使用runtime修饰。						
						
test						
当依赖的scope为test的时候，指的的是在测试范围有效，在编译与打包的时候都不会使用这个依赖。						
						
import						
maven多模块项目结构中，可以使用parent 定义父项目，实现从父项目中继承依赖。但maven只能单继承，即一个项目只能使用一个parent标签定义父项目。						
maven2.9之后的版本引入了一个新的功能，可以实现依赖上的多重继承。这个功能可以将依赖配置复杂的pom文件拆分成多个独立的pom文件。这样处理可以使得maven的pom配置更加简洁，同时可以复用这些pom依赖。						
比如，我们在开发spring boot 项目的时候，pom中会有如下配置：
```
<parent>						
    <groupId>org.springframework.boot</groupId>						
    <artifactId>spring-boot-starter-parent</artifactId>						
    <version>1.3.3.RELEASE</version>						
</parent>
```
但是，如果该项目是个maven子模块的话，就会出现问题。由于maven类似java是单继承，不能有两个parent，现在<parent></parent>标签已经用来引用父模块，现在又用来引用springboot，就会产生冲突。						
那解决办法就是： 使用dependencyManagement引入dependency，并且把scope属性改为import。如下：
```
<dependencyManagement>						
    <dependencies>						
        <dependency>						
            <groupId>org.springframework.boot</groupId>						
            <artifactId>spring-boot-dependencies</artifactId>						
            <version>2.1.6.RELEASE</version>						
            <type>pom</type>						
            <scope>import</scope>						
        </dependency>						
    </dependencies>						
</dependencyManagement>						
 						
<dependencies>						
    <dependency>						
        <groupId>org.springframework.boot</groupId>						
        <artifactId>spring-boot-starter-web</artifactId>						
    </dependency>						
</dependencies>	
```
注意：scope的import 属性只能在<dependencyManagement> 中使用，表示从其它的pom文件中导入dependency配置。						

### maven 引入外部jar包的几种方式				
**方式1：dependency 本地jar包** 
```				
<dependency>			
	<groupId>com.hope.cloud</groupId>  <!--自定义-->			
	<artifactId>cloud</artifactId>    <!--自定义-->			
	<version>1.0</version> <!--自定义-->			
	<scope>system</scope> <!--system，类似provided，需要显式提供依赖的jar以后，Maven就不会在Repository中查找它-->			
	<systemPath>${basedir}/lib/cloud.jar</systemPath> <!--项目根目录下的lib文件夹下-->			
</dependency> 			
```								
**方式2：编译阶段指定外部lib**			
```				
<plugin>			
	<artifactId>maven-compiler-plugin</artifactId>			
	<version>2.3.2</version>			
	<configuration>			
		<source>1.8</source>			
		<target>1.8</target>			
		<encoding>UTF-8</encoding>			
		<compilerArguments>			
			<extdirs>lib</extdirs><!--指定外部lib-->			
		</compilerArguments>			
	</configuration>			
</plugin>			
```				
**方式3：将外部jar打入本地maven仓库**			
cmd 进入jar包所在路径，执行以下命令:  		
mvn install:install-file -Dfile=cloud.jar -DgroupId=com.hope.cloud -DartifactId=cloud -Dversion=1.0 -Dpackaging=jar			
引入依赖			
```					
<dependency>			
	<groupId>com.hope.cloud</groupId>			
	<artifactId>cloud</artifactId>			
	<version>1.0</version>			
</dependency>			
```					
### MAVEN依赖关系中Scope的作用
POM文件里面可以引用一些内置属性(Maven预定义可以直接使用) 
```		
${basedir} 项目根目录   	
${version}表示项目版本;  	
${project.basedir}同${basedir};  	
${project.version}表示项目版本,与${version}相同;  	
${project.build.directory} 构建目录，缺省为target  	
${project.build.sourceEncoding}表示主源码的编码格式;  	
${project.build.sourceDirectory}表示主源码路径;  	
${project.build.finalName}表示输出文件名称;  	
${project.build.outputDirectory} 构建过程输出目录，缺省为target/classes 	
```			
Dependency Scope 在POM 4中，<dependency>中还引入了<scope>，它主要管理依赖的部署。目前依赖项的作用域<scope>可以使用5个值：    	
在定义项目的依赖项的时候，我们可以通过scope来指定该依赖项的作用范围。scope的取值有compile、runtime、test、provided、system和import。  	
compile：这是依赖项的默认作用范围，即当没有指定依赖项的scope时默认使用compile。compile范围内的依赖项在所有情况下都是有效的，包括运行、测试和编译时。  	
runtime：表示该依赖项只有在运行时才是需要的，在编译的时候不需要。这种类型的依赖项将在运行和test的类路径下可以访问。  	
test：表示该依赖项只对测试时有用，包括测试代码的编译和运行，对于正常的项目运行是没有影响的。  	
provided：表示该依赖项将由JDK或者运行容器在运行时提供，也就是说由Maven提供的该依赖项我们只有在编译和测试时才会用到，而在运行时将由JDK或者运行容器提供。  	
system：当scope为system时，表示该依赖项是我们自己提供的，不需要Maven到仓库里面去找。指定scope为system需要与另一个属性元素systemPath一起使用，它表示该依赖项在当前系统的位置，使用的是绝对路径。 	
	
如何在Maven项目中引入本地包呢？	
比如我从其它项目打一个jar包，引入到现有项目中。	
方法一：将待引入的包放在目录下如lib目录下，修改pom文件，加入依赖并且scope要设置为system	 
```		
<dependencies>  
	<dependency>  
		<groupId>com.fbcds</groupId>  
		<artifactId>fbcds</artifactId>  
		<version>1.0</version>  
		<scope>system</scope>  
		<systemPath>${project.basedir}/lib/fbcds.jar</systemPath>  
	</dependency>  
</dependencies>  
```		
上面设置完成后，运行mvn package命令执行成功。但打出来的包里面不包含lib目录和fbcds.jar这个引用的包，即打出来的包不是可执行的jar。
所以个人开发的话可以使用这种方式，如果团队开发请使用方法二。	
方法二：将待引入的jar包安装到本地repository中	
1、先把待引入的jar包放在一个目录下，需要改一下包名，如fbcds.jar修改成fbcds-1.0.jar，如F:\lib目录，在命令行CD到lib目录，执行以下命令:	
	mvn install:install-file -Dfile=fbcds-1.0.jar -DgroupId=fbcds -DartifactId=fbcds -Dversion=1.0 -Dpackaging=jar  
	mvn install:install-file -Dfile=ojdbc7-1.0.jar -DgroupId=ojdbc7 -DartifactId=ojdbc7 -Dversion=1.0 -Dpackaging=jar  
 2、修改项目pom文件加入包对应的依赖	  
```	
<dependencies>  
	<dependency>  
		<groupId>log4j</groupId>  
		<artifactId>log4j</artifactId>  
		<version>1.2.17</version>  
	</dependency>  
	<dependency>  
		<groupId>fbcds</groupId>  
		<artifactId>fbcds</artifactId>  
		<version>1.0</version>  
	</dependency>  
	<dependency>   
		<groupId>ojdbc7</groupId>  
		<artifactId>ojdbc7</artifactId>  
		<version>1.0</version>   
	</dependency>  
</dependencies>  
```		
上面的fbcds和ojdbc7就是新加的引用包的依赖。完成后，在本地仓库可看到对应的文件夹内容。
