## Express-基础
### Router：	
	1.  什么是router路径，什么是middleware？
	
	我们输入www.baidu.com 来访问百度的主页，浏览器会自动转换为 http://www.baidu.com:80/(省略一些参数)。 http://代表我们同服务器连接使用的是http协议，www.baidu.com 代表的是服务器的主机地址，会被我们的pc通过DNS解析为IP地址。
	80是默认的应用层端口。/ 即为我们访问的服务器(www.baidu.com)的路径，服务器要对我们访问的这个路径做出响应，采取一定的动作。我们可以把这一过程看做一个路由。
	 访问的路径‘/’即为router的路径，服务器采取的动作即为middleware，即为一个个特殊的函数。
	
	2. router路径
	路径为 /test：
	www.baidu.com/test
	 路径同样为/test, ?后面会被服务器理解传给路径的参数：
	www.baidu.com/test?name=1&number=2
	
	3. Middleware 
	
	An Express application is essentially a stack of middleware which are executed serially.(express应用其实就是由一系列顺序执行的Middleware组成。)
	A middleware is a function with access to the request object (req), the response object (res), and the next middleware in line in the request-response cycle of an Express application. It is commonly denoted by a variable named next. Each middleware has the capacity to execute any code, make changes to the request and the reponse object, end the request-response cycle, and call the next middleware in the stack. Since middleware are execute serially, their order of inclusion is important.(中间件其实就是一个访问express应用串入的req，res，nex参数的函数，这个函数可以访问任何通过req，res传入的资源。)
	If the current middleware is not ending the request-response cycle, it is important to call next() to pass on the control to the next middleware, else the request will be left hanging.(如果当前中间件没有完成对网页的res响应 ，还可以通过next把router 留给下一个middleware继续执行)
	With an optional mount path, middleware can be loaded at the application level or at the router level. Also, a series of middleware functions can be loaded together, creating a sub-stack of middleware system at a mount point.
	
	
	
	路由的产生是通过HTTP的各种方法(GET, POST)产生的，Middleware可以跟router路径跟特定的HTTP方法绑定，也可以跟所有的方法绑定。
	
	　　3.1 通过express应用的use（all），把Middleware同router路径上的所有HTTP方法绑定：
	
	1 app.use(function (req, res, next) {
	2   console.log('Time: %d', Date.now());
	3   next();
	4 })
	
	
	
	　　3.2 通过express应用的http.verb，把Middleware同router路径上的特定的HTTP方法绑定：
	
	
	
	1 app.get('/', function(req, res){
	2   res.send('hello world');
	3 });
	4
	5
	6 app.post('/', function(req, res){
	7   res.send('hello world');
	8 });
	
	4.  Express的Router对象
	
	　　当express实例的路由越来越多的时候，最好把路由分类独立出去，express的实例(app) 能更好的处理其他逻辑流程。Express的Router对象是一个简化的 app实例，只具有路由相关的功能，包括use, http verbs等等。
	最后这个Router再通过app的use挂载到app的相关路径下。
	
	
	
	
	 1 var express = require('express');
	 2 var app = express();
	 3 var router = express.Router();
	4
	 5 // simple logger for this router's requests
	 6 // all requests to this router will first hit this middleware
	 7 router.use(function(req, res, next) {
	 8   console.log('%s %s %s', req.method, req.url, req.path);
	 9   next();
	10 });
	11
	12 // this will only be invoked if the path ends in /bar
	13 router.use('/bar', function(req, res, next) {
	14   // ... maybe some additional /bar logging ...
	15   next();
	16 });
	17
	18 // always invoked
	19 router.use(function(req, res, next) {
	20   res.send('Hello World');
	21 });
	22
	23 app.use('/foo', router);
	24
	25 app.listen(3000);
	
	
	router的路由必须通过app.use和app.verbs 挂载到app上才能被响应。所以上述代码，只有在app捕捉到 /foo路径上的路由时，才能router中定义的路由，虽然router中有针对 '/' 的路由，但是被app中的路由给覆盖了。
	
	附：app.verbs和app.use的路由路径区别：
	先看一段测试代码：
	
	 var express = require('express');
	
	 var app = express();
	 var router = express.Router();
	
	 app.get('/', function(req, res){
	      console.log('test1');
	 });
	
	 app.use('/', function(req, res){
	      console.log('test2');
	 });
	
	 router.get('/', function(req, res){
	      console.log('test3');
	 });
	
	 app.listen(4000);
	
	输入url： localhost:4000
	输出结果：test1
	
	输入url： localhost:4000/hello
	输出结果：test2
	
	　　结论：app.get挂载‘/’的路由只响应跟'/'精确匹配的GET请求。 而app.use挂载的'/'的路由响应所有以'/' 为起始路由的路由，且不限制HTTP访问的方法。以下说明：
	Mounting a middleware at a path will cause the middleware function to be executed whenever the base of the requested path matches the path.
	
	1 app.use([path], [function...], function)
	2 Mount the middleware function(s) at the path. If path is not specified, it defaults to "/".
	3
	4 Mounting a middleware at a path will cause the middleware function to be executed whenever the base of the requested path matches the path.

### 路由转发中间件											
	1、express-http-proxy										
	2、http-proxy-middleware										
	以上两种中间件都能实现路由转发，如浏览器客户端发起请求，Nodejs中Express路由匹配后，转发为访问SpringBoot的后台API服务，而这个转发就是使用上述两种中间件。										
	注：如果所在公司使用上网代理，在本地调试时（即访问的后台API服务器地址包括localhost或127.0.0.1），不需要设置中件间的上网代理（设置了反而访问出错，										
	Response to preflight request doesn't pass access control check: Redirect is not allowed for a preflight request.）；										
	当访问已发布非本地的API服务器时，则必须设置中间件的上网代理，不然访问会报错（getaddrinfo ENOTFOUND）。										
											
	以下为部分代码展示：										
	1、app.js										
	var huiPubRouter = require('./routes/hui/huiPublicRouter');//公共路由										
	var huiProxyExpress = require('./routes/hui/huiProxyExpress');//使用express-http-proxy中间件										
	var huiProxyMiddle = require('./routes/hui/huiProxyMiddle');//使用http-proxy-middleware中间件										
											
	/*单独文件的路由,注必须在bodyParser前使用，否则SpringBoot后台使用@RequestBody接收数据时，会报错误：										
	* Resolved [org.springframework.http.converter.HttpMessageNotReadableException: I/O error while reading input message; 										
	* nested exception is org.apache.catalina.connector.ClientAbortException: java.net.SocketTimeoutException]										
	*/										
	app.use('/huipub', huiPubRouter.router);//public router										
	app.use('/huimid', huiProxyMiddle.router);//Middle router										
	app.use('/huiexp', huiProxyExpress.router);//Express router										
											
	app.use(bodyParser.json());										
	app.use(bodyParser.urlencoded({ extended: false }));										
											
	2、huiProxyTool.js										
	var HttpsProxyAgent = require('https-proxy-agent');//全局引用										
	var expressProxy = require('./proxy');//本地引用										
											
	//corporateProxyServer的内容为类似：http://{ip或域名}:{port}										
	var corporateProxyServer = process.env.http_proxy || process.env.HTTP_PROXY || process.env.https_proxy || process.env.HTTPS_PROXY;										
	var corporateProxyAgent;										
	if (corporateProxyServer) {										
	    corporateProxyAgent = new HttpsProxyAgent(corporateProxyServer);										
	}										
											
	var getProxyAgent = function(url) {										
	if(url.indexOf("localhost")== -1 && url.indexOf("127.0.0.1")==-1){										
	return corporateProxyAgent;//非本地模式										
	} else{										
	return null;//本地模式										
	}										
	}										
											
	function cleanResponseHeaders (rsp, data, req, res, cb) {										
	    res.removeHeader('Access-Control-Allow-Origin');										
	    cb(null, data);										
	}										
											
	function buildDecorator(zoneId,agent) {										
	    var decorator = function(req) {										
	        if (agent) {										
	            req.agent = agent;										
	        }										
	        req.headers['Content-Type'] = 'application/json';										
	        if (zoneId) {										
	            req.headers['Predix-Zone-Id'] = zoneId;										
	        }										
	        return req;										
	    };										
	    return decorator;										
	}										
											
	module.exports = {										
	getAgent:getProxyAgent,										
	cleanResponseHeaders:cleanResponseHeaders,										
	buildHeader:buildDecorator,										
	    addToken:expressProxy.addClientTokenMiddleware //简写方法										
	}										
											
	3、huiProxyToolExp.js										
	var expressProxy = require('express-http-proxy');//全局引用,代理转发中间件										
	var huiProxyTool = require('./huiProxyTool');//本地引用										
											
	//pathPrefixArray：路径替换数组										
	var proxyArray = function(pathPrefixArray, endpoint,zoneId) {										
	    let agent = huiProxyTool.getAgent(endpoint);//获取代理 										
	    let isHttps = endpoint.toLowerCase().startsWith('https://'); 										
	    return expressProxy(endpoint, {										
	        https: isHttps,										
	        forwardPath: function (req) {										
	            var path;										
	            Object.keys(pathPrefixArray).forEach(val=>{										
	                path = req.url.replace(val, pathPrefixArray[val] || '').trim();										
	            });										
	            console.log('body:'+JSON.stringify(req.body));										
	            console.log('Exp proxy to:', path);										
	            return path;										
	        },										
	        intercept: huiProxyTool.cleanResponseHeaders,										
	        decorateRequest: huiProxyTool.buildHeader(zoneId,agent)										
	    });										
	};										
	//这里将原请求中的body赋值给代理。pathPrefixArray：路径替换数组										
	var proxyArrayBody = function(pathPrefixArray, endpoint,zoneId) {   										
	    let agent = huiProxyTool.getAgent(endpoint);//获取代理										
	    let isHttps = endpoint.toLowerCase().startsWith('https://');										
	    return expressProxy(endpoint, {										
	        https: isHttps,										
	        forwardPath: function (req) {										
	            var path;										
	            Object.keys(pathPrefixArray).forEach(val=>{										
	                path = req.url.replace(val, pathPrefixArray[val] || '').trim();										
	            });										
	            //console.log('custom endpoint:' + endpoint);										
	            console.log('body:'+JSON.stringify(req.body));										
	            console.log('Exp proxy to:'+ path);										
	            return path;										
	        },										
	        intercept: huiProxyTool.cleanResponseHeaders,										
	        decorateRequest: function(proxyReq,originalReq){										
	            console.log('decorateRequest begin');										
	originalReq.agent = agent; 										
	originalReq.headers['Predix-Zone-Id'] = zoneId;										
	            originalReq.headers['Content-Type'] = 'application/json';										
	            //console.log('body:'+JSON.stringify(originalReq.body));										
	            proxyReq.body = originalReq.body;//这里不赋值，好像body传不到后台										
	            return proxyReq;										
	        }										
	    });										
	};										
											
	module.exports = {										
	proxyArray:proxyArray,										
	proxyArrayBody:proxyArrayBody,										
	AddClientToken:huiProxyTool.addToken,										
	}										
											
	4、huiProxyToolMid.js										
	var midProxy = require('http-proxy-middleware'); //全局引用,代理转发中间件										
	var huiProxyTool = require('./huiProxyTool');//本地引用										
											
	var proxyArray = function(pathRewriteObj, endpoint,zoneId) {										
	let agent = huiProxyTool.getAgent(endpoint);//获取代理										
	    return midProxy({										
	target: endpoint,										
	changeOrigin: true,										
	pathRewrite: pathRewriteObj,										
	agent:agent,										
	onProxyReq:function (proxyReq, req, res) {										
	if(zoneId){										
	req.headers['Predix-Zone-Id'] = zoneId;										
	}										
	            req.headers['Content-Type'] = 'application/json';										
	}										
	});										
	};										
											
	module.exports = {										
	proxyArray:proxyArray,										
	AddClientToken:huiProxyTool.addToken,										
	}										
											
											
	5、huiProxyExpress.js										
											
	var router = require('express').Router();//全局引用,路由对象										
	//本地引用										
	var proxyExp = require('../huiProxyToolExp');										
	var huiConfig = require('../../huiConfig');//全局配置										
											
	/**										
	* 概述：测试本地SpringBoot的API服务,要跨域										
	* 路由前缀：huiexp										
	* 功能：使用express-http-proxy中间件来转发API。这里通过引入proxy（其内调用express-http-proxy中间件）来处理。										
	*/										
											
	/**一、Predix公共API测试 */										
	/**1.1 asset test：注：不要使用【/pubassetapi/*】										
	* 测试情况：【Get】2019-06-21成功;【Post】2019-06-21成功*/										
	router.use(['/pubassetapi/query','/pubassetapi/save','/pubassetapi/delete'],										
	proxyExp.AddClientToken,										
	function(req, res, next) {										
	//req.headers['Predix-Zone-Id'] = huiConfig.predixMyEnv.assetZoneId;										
	console.log('exp URL:'+req.url);										
	next();										
	},										
	proxyExp.proxyArray({'/pubassetapi/query':'','/pubassetapi/save':'','/pubassetapi/delete':''}, 										
	huiConfig.predixPub.asset.url,huiConfig.predixMyEnv.assetZoneId)										
	); 										
											
	/**1.2 times test：										
	* 查询数据：要使用POST获取数据。测试过GET，失败。										
	* 注：客户端要使用/myapi/pubtimesquery/v1/datapoints来发起POST请求，而不是/myapi/pubtimesquery(报405错误，Method Not Allowed) 										
	* 维护数据：										
	*/										
	/*1.2.1、查询数据：【Post】2019-06-04测试成功，URL：huiexp/pubtimesquery/v1/datapoints										
	*注：不要使用【/pubtimesquery/*】，另外，这里不知为啥用router.post不行，调用不了										
	*/										
	router.use('/pubtimesquery', //不要使用【/pubtimesquery/*】，另外，这里不知为啥用router.post不行，调用不了										
	proxyExp.AddClientToken,										
	function(req, res, next) { 										
	//req.headers['Predix-Zone-Id'] = huiConfig.predixMyEnv.timeseriesZoneId;										
	console.log('body:'+JSON.stringify(req.body));										
	console.log('exp URL:'+req.url);										
	next();										
	},										
	proxyExp.proxyArray({'/pubtimesquery':''}, 										
	huiConfig.predixPub.times.query.host,										
	huiConfig.predixMyEnv.timeseriesZoneId)										
	); 										
											
	/*1.2.2、维护数据：未测试*/										
	router.use('/pubtimesapisave',										
	proxyExp.AddClientToken,										
	function(req, res, next) { 										
	//req.headers['Predix-Zone-Id'] = huiConfig.predixMyEnv.timeseriesZoneId;										
	next();										
	},										
	proxyExp.proxyArray({'/pubtimesapisave':''}, 										
	huiConfig.predixPub.times.socket.host,huiConfig.predixMyEnv.timeseriesZoneId)										
	); 										
											
	/**二、个人SpringBoot后台的API测试 */										
	router.use(['/myassetapi','/myassetsdk'], 										
	proxyExp.AddClientToken,										
	function(req, res, next) {										
	//console.log('body:'+JSON.stringify(req.body));										
	//console.log('Predix-Zone-Id:'+req.headers['Predix-Zone-Id']);										
	//console.log('exp url:'+req.url);										
	next();										
	},										
	proxyExp.proxyArrayBody({'/myassetapi':'','/myassetsdk':''}, 										
	huiConfig.windServiceURL,										
	huiConfig.predixMyEnv.assetZoneId)										
	);										
	router.use(['/mytimesapi','/mytimessdk','/myposttest'], 										
	proxyExp.AddClientToken,										
	function(req, res, next) {										
	//console.log('body:'+JSON.stringify(req.body));										
	//console.log('Predix-Zone-Id:'+req.headers['Predix-Zone-Id']);										
	//console.log('exp url:'+req.url);										
	next();										
	},										
	proxyExp.proxyArrayBody({'/mytimesapi':'','/mytimessdk':'','/myposttest':''}, 										
	huiConfig.windServiceURL,										
	huiConfig.predixMyEnv.timeseriesZoneId)										
	);										
											
	/**三、simulator的SDK测试 */										
	router.use('/mysimulator', 										
	proxyExp.AddClientToken,										
	function(req, res, next) {										
	//console.log('body:'+JSON.stringify(req.body));										
	console.log('exp url:'+req.url);										
	next();										
	},										
	proxyExp.proxyArray({'/mysimulator':''}, huiConfig.simulatorServerURL)//注：这里使用simulatorServerURL										
	);										
											
	module.exports = {										
	router:router										
	}										
											
											
	6、huiProxyMiddle.js										
	var router = require('express').Router();//全局引用,路由对象										
	//本地引用										
	var huiConfig = require('../../huiConfig');//全局配置										
	var proxyMid = require('../huiProxyToolMid');										
											
	/*** 概述：测试本地SpringBoot的API服务,要跨域。路由前缀：huimid*/										
	/**一、Predix公共API测试：注必须设置代理 */										
	/**1.1 asset test										
	* GET：2019-06-24测试成功。										
	* 如果不设置代理，会报报Error: getaddrinfo ENOTFOUND predix-asset.run.aws-usw02-pr.ice.predix.io错误。										
	* POST：										
	*/										
	router.use(['/pubassetapi/query','/pubassetapi/save'],										
	proxyMid.AddClientToken,										
	function(req, res, next) {										
	//addHeader(huiConfig.predixMyEnv.assetZoneId);										
	console.log('mid pubassetapi URL:'+req.url); 										
	next();//注：最容易犯的错误是少了next()，然后就调用不到后面的代理，导致查不出数据！！										
	},										
	proxyMid.proxyArray({'^/huimid/pubassetapi/query' : '','^/huimid/pubassetapi/save' : ''},										
	huiConfig.predixPub.asset.url,huiConfig.predixMyEnv.assetZoneId)										
	); 										
											
	/**1.2 times test：										
	* 查询数据：要使用POST获取数据。测试过GET，失败。										
	* 注：客户端要使用/myapi/pubtimesapiquery/v1/datapoints来发起请求，而不是/myapi/pubtimesapiquery(报405错误，Method Not Allowed) 										
	* 维护数据：										
	*/										
	/*1.2.1、查询数据：2019-06-13测试失败*/										
	router.use('/pubtimesquery', 										
	proxyMid.AddClientToken,										
	function(req, res, next) { 										
	//addHeader(huiConfig.predixMyEnv.timeseriesZoneId);										
	console.log('mid pubtimesquery URL:'+req.url);										
	next();										
	},										
	proxyMid.proxyArray({'^/huimid/pubtimesquery' : ''},										
	huiConfig.predixPub.times.query.host,huiConfig.predixMyEnv.timeseriesZoneId)										
	); 										
											
	/*1.2.2、维护数据：未测试*/										
	router.use('/pubtimessave',										
	proxyMid.AddClientToken,										
	function(req, res, next) { 										
	//addHeader(huiConfig.predixMyEnv.timeseriesZoneId);										
	console.log('mid pubtimessave URL:'+req.url);										
	next();										
	},										
	proxyMid.proxyArray({'^/huimid/pubtimessave' : ''},										
	huiConfig.predixPub.times.socket.host,huiConfig.predixMyEnv.timeseriesZoneId)										
	); 										
											
	/**二、个人SpringBoot后台的API及SDK测试 */										
	/*利用http-proxy-middleware中间件：										
	* GET：										
	* Asset:2019-06-05测试成功										
	* TimeSeries:										
	* POST：										
	* Asset:										
	* 注：路径替换中，必须要加上前一个路由匹配的【/huimid】，例如【'^/huimid/myapitest' : ''】，要不会报【404 (Not Found)】错误。										
	*/										
	//路由转发										
	router.use(['/myapitest','/myposttest','/myassetapi','/myassetsdk','/mytimesapi','/mytimessdk'], 										
	proxyMid.AddClientToken,										
	function(req, res, next) {										
	console.log('body:'+JSON.stringify(req.body));										
	console.log('mid all url:'+req.url);										
	next();										
	},										
	proxyMid.proxyArray({'^/huimid/myapitest' : '','^/huimid/myposttest' : '','^/huimid/myassetapi' : '',										
	'^/huimid/myassetsdk' : '','^/huimid/mytimesapi' : '','^/huimid/mytimessdk' : '',},										
	huiConfig.windServiceURL)										
	);										
	/**三、simulator的SDK测试 */										
	router.use(['/mysimulator'], 										
	proxyMid.AddClientToken,										
	function(req, res, next) {										
	console.log('body:'+JSON.stringify(req.body));										
	console.log('mid all url:'+req.url);										
	next();										
	},										
	proxyMid.proxyArray({'^/huimid/mysimulator' : ''}, huiConfig.simulatorServerURL)										
	);										
											
	module.exports = {										
	router:router										
	}										
											
											
	7、proxy.js										
	前面的huiProxyTool.js只用到其addClientTokenMiddleware方法作为addClientToken导出给其他JS文件使用。										
	/**										
	* This module can be used to set up reverse proxying from client to Predix services.										
	* It assumes only one UAA instance, one UAA client, and one instance of each service.										
	* Use setUaaConfig() and setServiceConfig() for local development.										
	* In cloud foundry, set the following environment vars: base64ClientCredential										
	* Info for bound services is read from VCAP environment variables.										
	*/										
											
	var url = require('url');										
	var express = require('express');										
	var expressProxy = require('express-http-proxy');										
	var HttpsProxyAgent = require('https-proxy-agent');										
	var predixUaaClient = require('predix-uaa-client');										
	var predixConfig = require('../predix-config');										
	var router = express.Router();										
	var vcapServices = {};										
											
	var corporateProxyServer = process.env.http_proxy || process.env.HTTP_PROXY || process.env.https_proxy || process.env.HTTPS_PROXY;										
	var corporateProxyAgent;										
	if (corporateProxyServer) {										
	    corporateProxyAgent = new HttpsProxyAgent(corporateProxyServer);										
	}										
											
	var clientId = predixConfig.getClientIdFromEncodedString(process.env.base64ClientCredential);										
	var base64ClientCredential = process.env.base64ClientCredential;										
	var uaaURL = (function() {										
	    var vcapsServices = process.env.VCAP_SERVICES ? JSON.parse(process.env.VCAP_SERVICES) : {};										
	    var uaaService = vcapsServices[process.env.uaa_service_label || 'predix-uaa'];										
	    var uaaURL;										
											
	    if(uaaService) {										
	        uaaURL = uaaService[0].credentials.uri;										
	    }										
	    return uaaURL;										
	}) ();										
											
	// Pass a VCAPS object here if desired, for local config.										
	// Otherwise, this module reads from VCAP_SERVICES environment variable.										
	var setServiceConfig = function(vcaps) {										
	    vcapServices = vcaps;										
	    setProxyRoutes();										
	};										
											
	var setUaaConfig = function(options) {										
	    if (predixConfig.isUaaConfigured()) {										
	        uaaURL = options.uaaURL || uaaURL;										
	        base64ClientCredential = options.base64ClientCredential || base64ClientCredential;										
	        clientId = predixConfig.getClientIdFromEncodedString(base64ClientCredential);										
	    }										
	};										
											
	var getClientToken = function(successCallback, errorCallback) {										
	    var clientSecret = predixConfig.getSecretFromEncodedString(base64ClientCredential);										
	    predixUaaClient.getToken(uaaURL + '/oauth/token', clientId, clientSecret).then(function (token) {										
	            successCallback(token.token_type + ' ' + token.access_token);										
	    }).catch(function (err) {										
	        console.error('ERROR fetching client token:', err);										
	        if (errorCallback) {										
	            errorCallback(err);										
	        }										
	    });										
	};										
											
	function cleanResponseHeaders (rsp, data, req, res, cb) {										
	    res.removeHeader('Access-Control-Allow-Origin');										
	    cb(null, data);										
	}										
											
	function buildDecorator(zoneId) {										
	    var decorator = function(req) {										
	        if (corporateProxyAgent) {										
	            req.agent = corporateProxyAgent;										
	        }										
	        req.headers['Content-Type'] = 'application/json';										
	        if (zoneId) {										
	            req.headers['Predix-Zone-Id'] = zoneId;										
	        }										
	        return req;										
	    };										
	    return decorator;										
	}										
											
	function isValidUrl(str) {										
	    var urlObj = url.parse(str);										
	    return urlObj.protocol === 'https:' && urlObj.host;										
	}										
											
	function getEndpointAndZone(key, credentials) {										
	    var out = {};										
	    // ugly code needed since vcap service variables are not consistent across services										
	    // TODO: all the other predix services										
	    if (key === 'predix-uaa') {										
	        // do nothing. authentication handled by the passport module.										
	        // return here, so we don't display a confusing log message.										
	        return out;										
	    } else if (key === 'predix-asset') {										
	        out.serviceEndpoint = isValidUrl(credentials.uri) ? credentials.uri : null;										
	        out.zoneId = credentials.zone['http-header-value'];										
	    } else if (key === 'predix-timeseries') {										
	        var urlObj = url.parse(credentials.query.uri);										
	        out.serviceEndpoint = urlObj.host ? urlObj.protocol + '//' + urlObj.host : null;										
	        out.zoneId = credentials.query['zone-http-header-value'];										
	    }										
	    if (!out.serviceEndpoint) {										
	        console.log('no proxy set for service: ' + key);										
	    }										
	    return out;										
	}										
											
	var setProxyRoute = function(key, credentials) {										
	    // console.log(JSON.stringify(credentials));										
	    var routeOptions = getEndpointAndZone(key, credentials);										
	    if (!routeOptions.serviceEndpoint) {										
	        return;										
	    }										
	    console.log('setting proxy route for key: ' + key);										
	    console.log('serviceEndpoint: ' + routeOptions.serviceEndpoint);										
	    // console.log('zone id: ' + routeOptions.zoneId);										
	    var decorator = buildDecorator(routeOptions.zoneId);										
											
	    router.use('/' + key, expressProxy(routeOptions.serviceEndpoint, {										
	        https: true,										
	        forwardPath: function (req) {										
	            console.log('req.url: ' + req.url);										
	            return req.url;										
	        },										
	        intercept: cleanResponseHeaders,										
	        decorateRequest: decorator										
	    }));										
	};										
											
	// Fetches client token, adds to request headers, and stores in session.										
	// Returns 403 if no session.										
	// Use this middleware to proxy a request to a secure service, using a client token.										
	var addClientTokenMiddleware = function(req, res, next) {										
	    function errorHandler(errorString) {										
	        var err = new Error(errorString);										
	       err.status = 500;										
	       next(err);										
	    }										
	    // console.log('proxy root route');										
	    if (req.session) {										
	        // console.log('session found.');										
	        // console.log('fetching client token');										
	        // getClientToken will returned a cached token if it's not expired										
	        // or renew if it has expired.										
	        getClientToken(function(token) {										
	            req.headers['Authorization'] = token;										
	            next();										
	        }, errorHandler);										
	    } else {										
	        next(res.sendStatus(403).send('Forbidden'));										
	    }										
	};										
											
	router.use(['/'], addClientTokenMiddleware);										
											
	// Adds user authorization token from passport to request										
	var addAccessTokenMiddleware = function (req, res, next) {										
	    if (req.session) {										
	        req.headers['Authorization'] = 'bearer ' + req.session.passport.user.ticket.access_token;										
	        next();										
	    } else {										
	        next(res.sendStatus(403).send('Forbidden'));										
	    }										
	};										
											
	// TODO: Support for multiple instances of the same service.										
	var setProxyRoutes = function() {										
	    var vcapString = process.env.VCAP_SERVICES;										
	    var serviceKeys = [];										
	    vcapServices = vcapString ? JSON.parse(vcapString) : vcapServices;										
	    console.log('vcaps: ' + JSON.stringify(vcapServices));										
											
	    serviceKeys = Object.keys(vcapServices);										
	    serviceKeys.forEach(function(key) {										
	        setProxyRoute(key, vcapServices[key][0].credentials);										
	    });										
	};										
	// TODO: only call this, if we find a vcapstring in environment?										
	setProxyRoutes();										
											
	// Use this to set up your own proxy route to your custom microservice.										
	// Path and arguments after the pathPrefix will be passed on to the target endpoint.										
	// pathPrefix: the path that clients will call in your express app.										
	// endpoint: the URL of your custom microservice.										
	// targetPath: optional path to proxy to. if set, the pathPrefix will be replaced with targetPath.										
	// example usage:										
	// customProxyMiddleware('/my-custom-api', 'https://my-custom-service.run.aws-usw02-pr.ice.predix.io')										
	// customProxyMiddleware('/another-api', 'https://another-api.run.aws-usw02-pr.ice.predix.io', '/v3/special-api-path')										
	var customProxyMiddleware = function(pathPrefix, endpoint, targetPath) {										
	    console.log('custom endpoint: ' + endpoint);										
	    return expressProxy(endpoint, {										
	        https: true,										
	        forwardPath: function (req) {										
	            var path = req.url.replace(pathPrefix, targetPath || '');										
	            console.log('proxying to:', path);										
	            return path;										
	        },										
	        intercept: cleanResponseHeaders,										
	        decorateRequest: buildDecorator()										
	    });										
	};										
											
	module.exports = {										
	    router: router,										
	    setServiceConfig: setServiceConfig,										
	    setUaaConfig: setUaaConfig,										
	    customProxyMiddleware: customProxyMiddleware,										
	    addClientTokenMiddleware: addClientTokenMiddleware,										
	    addAccessTokenMiddleware: addAccessTokenMiddleware,										
	    expressProxy: expressProxy,										
	};										
											
	huiPublicRouter.js										
	var router = require('express').Router();										
	var proxyTool = require('../huiProxyTool'); // used when requesting data from real services.										
	var huiConfig = require('../../huiConfig');//全局配置										
											
	/**路由前缀：huipub*/										
	/*为了让界面不经过Expess转发，直接调用后端，这里提供一个获取Token方法，方便其加到头里边:测试通过*/										
	router.get('/mytoken',										
	proxyTool.addToken,										
	function(req, res) {										
	res.send({token: req.headers['Authorization']});										
	}										
	);										
	//获取个人全局配置										
	router.use('/huiconfig', function(req, res) {//发送全局配置										
	  res.send(huiConfig);										
	});										
											
	module.exports = {										
	router:router										
	};										
											
											
	huiConfig.js										
	个人的API相关的全部配置										
	/** 个人predix环境配置，需要修改*/										
	var predixMyEnv = {										
	"assetZoneId": "4264ad9d-11bf-49d1-a4d7-2522a40ae62b",										
	"timeseriesZoneId": "c9d2f2a7-c46c-47ca-85c2-05b94627bf54",										
	"contextPath":{										
	"winddata":"/services",										
	"simulator":""										
	},										
	"development": { //开发环境配置，需要修改 										
	"windServiceURL": "http://localhost:9092",										
	"simulatorServerURL": "http://localhost:9093"										
	},										
	"cloud":{ //云环境配置，需要修改 										
	"windServiceURL": "https://hgh-my-winddata-service.run.aws-usw02-pr.ice.predix.io",										
	"simulatorServerURL": "https://hgh-data-exchange-simulator.run.aws-usw02-pr.ice.predix.io"										
	}										
	}										
	//全局公共值，一般不需要修改										
	var globalValue={										
	"contentTypeJson":"application/json;charset=utf-8",										
	"AccessCORS":"Access-Control-Allow-Origin",										
	"headerKey":{										
	"auth": "Authorization",										
	"zoneId":"Predix-Zone-Id"										
	}										
	};										
											
	/** Express router Path all*/										
	var pathExp={										
	"root":{										
	"pub":"/huipub",										
	"exp":"/huiexp",										
	"mid":"/huimid",										
	},										
	"asset":{										
	"api" : "/myassetapi",										
	"sdk" : "/myassetsdk",										
	"pub" : "/pubassetapi"										
	},										
	"times":{										
	"api" : "/mytimesapi",										
	"sdk" : "/mytimessdk",										
	"pubQuery" : "/pubtimesquery",										
	"pubSave" : "/pubtimesapisave"										
	},										
	"postTest":{ "api" : "/myposttest" },										
	"simulator":{ "api" : "/mysimulator" }										
	};										
	/** Spring router Path*/										
	var pathSpring={										
	"asset":{										
	"api":"/huiassetapi",										
	"sdk":"/huiassetsdk",										
	},										
	"times":{										
	"api":"/huitimesapi",										
	"sdk":"/huitimessdk",										
	},										
	"postTest":{										
	"api":"/huiposttest"										
	}										
	};										
	/** Spring router Path to Mothod*/										
	var pathSpringMothod={										
	"asset":{										
	"query":"/query",										
	"save":"/save",										
	"delete":"/delete",										
	"ping":"/ping",										
	},										
	"times":{										
	"api":{										
	"history":"/history_data",//历史数据										
	"latest":"/latest_data",//实时数据										
	},										
	"sdk":{										
	"history":"/history_data/sensor_id",//历史数据										
	"latest":"/latest_data/sensor_id",//实时数据										
	},										
	"save":"/save",										
	//"delete":"/delete",										
	"ping":"/ping",										
	"tags":"/tags",										
	},										
	"postTest":{										
	"nobody":"/postnobody",										
	"bodyString":"/postbodystr",										
	"bodyEntity":"/postbodyobj",										
	"bodyMap":"/postbodymap",										
	"objectRequest":"/postrequest",										
	}										
	};										
											
	//predix公共，不用修改										
	var predixPub = {										
	"asset":{										
	"url":"https://predix-asset.run.aws-usw02-pr.ice.predix.io"										
	},										
	"times":{										
	"query":{										
	"fullUrlHistory":"https://time-series-store-predix.run.aws-usw02-pr.ice.predix.io/v1/datapoints",										
	"fullUrlLatest":"https://time-series-store-predix.run.aws-usw02-pr.ice.predix.io/v1/datapoints/latest",										
	"fullUrlTags":"https://time-series-store-predix.run.aws-usw02-pr.ice.predix.io/v1/tags",										
	"host": "https://time-series-store-predix.run.aws-usw02-pr.ice.predix.io",										
	"pointsHistoryPath":"/v1/datapoints",										
	"pointsLatestPath":"/v1/datapoints/latest",										
	"tagsPath":"/v1/tags",										
	},										
	"socket":{										
	"fullUrl":"wss://gateway-predix-data-services.run.aws-usw02-pr.ice.predix.io/v1/stream/messages",										
	"host":"wss://gateway-predix-data-services.run.aws-usw02-pr.ice.predix.io",										
	}										
	}										
	};										
	var simulatorPath={										
	"query":"/simulations",										
	"start":"/start-simulation",										
	"stop":"/stop-simulation"										
	}										
											
	let oGetDatType={										
	"pub":"0",										
	"api":"1",										
	"sdk":"2"										
	};										
	let oSendType={										
	"direct":"0",										
	"exp":"1",										
	"mid":"2"										
	}										
	let windServiceURL;										
	let simulatorServerURL;										
	var node_env = process.env.node_env || 'development';										
	if (node_env === 'development') { //开发环境										
	  windServiceURL = predixMyEnv.development.windServiceURL;										
	  simulatorServerURL = predixMyEnv.development.simulatorServerURL;										
	} else { //云环境										
	  windServiceURL = predixMyEnv.cloud.windServiceURL;										
	  simulatorServerURL = predixMyEnv.cloud.simulatorServerURL;										
	}										
											
	var assetTool={										
	fullPath:function (sType,sFinal) {										
	let assetFull = windServiceURL + predixMyEnv.contextPath.winddata;										
	let sClass;										
	if(sType==oGetDatType.pub){										
	sClass = "";										
	} else if(sType==oGetDatType.api){										
	sClass = pathSpring.asset.api;										
	} else {										
	sClass = pathSpring.asset.sdk;										
	}										
	return assetFull + sClass + sFinal;										
	},										
	expPath:function (sendType,sType,sFinal) {										
	let assetFull;										
	let sRoot = "";										
	if(sendType==oSendType.exp){										
	sRoot = pathExp.root.exp										
	} else if (sendType==oSendType.mid){										
	sRoot = pathExp.root.mid;										
	}										
											
	if(sType=="0"){//pub										
	assetFull = sRoot + pathExp.asset.pub;										
	} else if(sType=="1"){										
	assetFull = sRoot + pathExp.asset.api + predixMyEnv.contextPath.winddata + pathSpring.asset.api;										
	} else {										
	assetFull = sRoot + pathExp.asset.sdk + predixMyEnv.contextPath.winddata + pathSpring.asset.sdk;										
	}										
	return assetFull + sFinal;										
	}										
	};										
											
	var timesTool={										
	fullPath:function (sType,sFinal) {										
	let timesFull = windServiceURL + predixMyEnv.contextPath.winddata;										
	let sClass;										
	if(sType==oGetDatType.pub){										
	sClass = "";										
	} else if(sType==oGetDatType.api){										
	sClass = pathSpring.times.api;										
	} else {										
	sClass = pathSpring.times.sdk;										
	}										
	return timesFull + sClass + sFinal;										
	},										
	expPath:function (sendType,sType,sFinal) {										
	let timesFull;										
	let sRoot = "";										
	if(sendType==oSendType.exp){										
	sRoot = pathExp.root.exp										
	} else if (sendType==oSendType.mid){										
	sRoot = pathExp.root.mid;										
	}										
											
	if(sType=="0"){//pub										
	timesFull = sRoot + pathExp.times.pubQuery;										
	} else if(sType=="1"){										
	timesFull = sRoot + pathExp.times.api + predixMyEnv.contextPath.winddata + pathSpring.times.api;										
	} else {										
	timesFull = sRoot + pathExp.times.sdk + predixMyEnv.contextPath.winddata + pathSpring.times.sdk;										
	}										
	return timesFull + sFinal;										
	}										
	};										
											
	var postTestTool={										
	getPath:function (sendType,sFinal) {										
	let timesFull;										
	let sRoot = "";										
	if(sendType==oSendType.direct){										
	timesFull = windServiceURL + predixMyEnv.contextPath.winddata + pathSpring.postTest.api + sFinal;										
	}										
	else if(sendType==oSendType.exp){										
	sRoot = pathExp.root.exp + pathExp.postTest.api;										
	timesFull = sRoot + predixMyEnv.contextPath.winddata + pathSpring.postTest.api + sFinal;										
	} else{ //mid										
	sRoot = pathExp.root.mid + pathExp.postTest.api;										
	timesFull = sRoot + predixMyEnv.contextPath.winddata + pathSpring.postTest.api + sFinal;										
	}										
	return timesFull;										
	}										
	};										
											
	//Asset 环境数据										
	var assetEnv={										
	"full":{										
	"pub":{										
	"query":predixPub.asset.url,										
	"save": predixPub.asset.url,										
	"delete":predixPub.asset.url,										
	"ping":predixPub.asset.url										
	},										
	"api":{										
	"query":assetTool.fullPath(oGetDatType.api,pathSpringMothod.asset.query),										
	"save": assetTool.fullPath(oGetDatType.api,pathSpringMothod.asset.save),										
	"delete":assetTool.fullPath(oGetDatType.api,pathSpringMothod.asset.delete),										
	"ping":assetTool.fullPath(oGetDatType.api,pathSpringMothod.asset.ping),										
	},										
	"sdk":{										
	"query":assetTool.fullPath(oGetDatType.sdk,pathSpringMothod.asset.query),										
	"save": assetTool.fullPath(oGetDatType.sdk,pathSpringMothod.asset.save),										
	"delete":assetTool.fullPath(oGetDatType.sdk,pathSpringMothod.asset.delete),										
	"ping":assetTool.fullPath(oGetDatType.sdk,pathSpringMothod.asset.ping),										
	}										
	},										
	"exp":{										
	"pub":{										
	"query":assetTool.expPath(oSendType.exp,oGetDatType.pub,pathSpringMothod.asset.query),										
	"save": assetTool.expPath(oSendType.exp,oGetDatType.pub,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.exp,oGetDatType.pub,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.exp,oGetDatType.pub,pathSpringMothod.asset.ping),										
	},										
	"api":{										
	"query":assetTool.expPath(oSendType.exp,oGetDatType.api,pathSpringMothod.asset.query),										
	"save":assetTool.expPath(oSendType.exp,oGetDatType.api,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.exp,oGetDatType.api,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.exp,oGetDatType.api,pathSpringMothod.asset.ping),										
	},										
	"sdk":{										
	"query":assetTool.expPath(oSendType.exp,oGetDatType.sdk,pathSpringMothod.asset.query),										
	"save":assetTool.expPath(oSendType.exp,oGetDatType.sdk,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.exp,oGetDatType.sdk,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.exp,oGetDatType.sdk,pathSpringMothod.asset.ping),										
	}										
	},										
	"mid":{										
	"pub":{										
	"query":assetTool.expPath(oSendType.mid,oGetDatType.pub,pathSpringMothod.asset.query),										
	"save": assetTool.expPath(oSendType.mid,oGetDatType.pub,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.mid,oGetDatType.pub,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.mid,oGetDatType.pub,pathSpringMothod.asset.ping),										
	},										
	"api":{										
	"query":assetTool.expPath(oSendType.mid,oGetDatType.api,pathSpringMothod.asset.query),										
	"save":assetTool.expPath(oSendType.mid,oGetDatType.api,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.mid,oGetDatType.api,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.mid,oGetDatType.api,pathSpringMothod.asset.ping),										
	},										
	"sdk":{										
	"query":assetTool.expPath(oSendType.mid,oGetDatType.sdk,pathSpringMothod.asset.query),										
	"save":assetTool.expPath(oSendType.mid,oGetDatType.sdk,pathSpringMothod.asset.save),										
	"delete":assetTool.expPath(oSendType.mid,oGetDatType.sdk,pathSpringMothod.asset.delete),										
	"ping":assetTool.expPath(oSendType.mid,oGetDatType.sdk,pathSpringMothod.asset.ping),										
	}										
	}										
	};										
	//Times 环境数据										
	var timesEnv={										
	"full":{										
	"pub":{										
	"query":{										
	"history":predixPub.times.query.fullUrlHistory,										
	"latest":predixPub.times.query.fullUrlLatest,										
	},										
	"save":predixPub.times.socket.fullUrl,										
	"ping":predixPub.times.query.fullUrlHistory,										
	"tags":predixPub.times.query.fullUrlTags,										
	},										
	"api":{										
	"query":{										
	"history":timesTool.fullPath(oGetDatType.api,pathSpringMothod.times.api.history),										
	"latest":timesTool.fullPath(oGetDatType.api,pathSpringMothod.times.api.latest),										
	},										
	"save":timesTool.fullPath(oGetDatType.api,pathSpringMothod.times.save),										
	"ping":timesTool.fullPath(oGetDatType.api,pathSpringMothod.times.ping),										
	"tags":timesTool.fullPath(oGetDatType.api,pathSpringMothod.times.tags),										
	},										
	"sdk":{										
	"query":{										
	"history":timesTool.fullPath(oGetDatType.sdk,pathSpringMothod.times.sdk.history),										
	"latest":timesTool.fullPath(oGetDatType.sdk,pathSpringMothod.times.sdk.latest),										
	},										
	"save":timesTool.fullPath(oGetDatType.sdk,pathSpringMothod.times.save),										
	"ping":timesTool.fullPath(oGetDatType.sdk,pathSpringMothod.times.ping),										
	"tags":timesTool.fullPath(oGetDatType.sdk,pathSpringMothod.times.tags),										
	}										
	},										
	"exp":{										
	"pub":{//公共API										
	"query":{										
	"history":timesTool.expPath(oSendType.exp,"0",predixPub.times.query.pointsHistoryPath),										
	"latest":timesTool.expPath(oSendType.exp,"0",predixPub.times.query.pointsLatestPath),										
	},										
	"save":timesTool.expPath(oSendType.exp,"0",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.exp,"0",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.exp,"0",pathSpringMothod.times.tags),										
	},										
	"api":{										
	"query":{										
	"history":timesTool.expPath(oSendType.exp,"1",pathSpringMothod.times.api.history),										
	"latest":timesTool.expPath(oSendType.exp,"1",pathSpringMothod.times.api.latest),										
	},										
	"save":timesTool.expPath(oSendType.exp,"1",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.exp,"1",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.exp,"1",pathSpringMothod.times.tags),										
	},										
	"sdk":{										
	"query":{										
	"history":timesTool.expPath(oSendType.exp,"2",pathSpringMothod.times.sdk.history),										
	"latest":timesTool.expPath(oSendType.exp,"2",pathSpringMothod.times.sdk.latest),										
	},										
	"save":timesTool.expPath(oSendType.exp,"2",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.exp,"2",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.exp,"2",pathSpringMothod.times.tags),										
	}										
	},										
	"mid":{										
	"pub":{										
	"query":{										
	"history":timesTool.expPath(oSendType.mid,"0",predixPub.times.query.pointsHistoryPath),										
	"latest":timesTool.expPath(oSendType.mid,"0",predixPub.times.query.pointsLatestPath),										
	},										
	"save":timesTool.expPath(oSendType.mid,"0",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.mid,"0",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.mid,"0",pathSpringMothod.times.tags),										
	},										
	"api":{										
	"query":{										
	"history":timesTool.expPath(oSendType.mid,"1",pathSpringMothod.times.api.history),										
	"latest":timesTool.expPath(oSendType.mid,"1",pathSpringMothod.times.api.latest),										
	},										
	"save":timesTool.expPath(oSendType.mid,"1",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.mid,"1",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.mid,"1",pathSpringMothod.times.tags),										
	},										
	"sdk":{										
	"query":{										
	"history":timesTool.expPath(oSendType.mid,"2",pathSpringMothod.times.sdk.history),										
	"latest":timesTool.expPath(oSendType.mid,"2",pathSpringMothod.times.sdk.latest),										
	},										
	"save":timesTool.expPath(oSendType.mid,"2",pathSpringMothod.times.save),										
	"ping":timesTool.expPath(oSendType.mid,"2",pathSpringMothod.times.ping),										
	"tags":timesTool.expPath(oSendType.mid,"2",pathSpringMothod.times.tags),										
	}										
	}										
	};										
	//Simulator										
	var simulatorEnv={										
	"pub":{										
	"query":simulatorServerURL + simulatorPath.query,										
	"start":simulatorServerURL + simulatorPath.start,										
	"stop":simulatorServerURL + simulatorPath.stop										
	},										
	"exp":{										
	"query":pathExp.root.exp + pathExp.simulator.api + simulatorPath.query,										
	"start":pathExp.root.exp + pathExp.simulator.api + simulatorPath.start,										
	"stop":pathExp.root.exp + pathExp.simulator.api + simulatorPath.stop,										
	},										
	"mid":{										
	"query":pathExp.root.mid + pathExp.simulator.api + simulatorPath.query,										
	"start":pathExp.root.mid + pathExp.simulator.api + simulatorPath.start,										
	"stop":pathExp.root.mid + pathExp.simulator.api + simulatorPath.stop,										
	} 										
	};										
	//PostTest										
	var postTestEnv={										
	"pub":{//直发										
	"noBody":postTestTool.getPath(oSendType.pub,pathSpringMothod.postTest.nobody),										
	"bodyString":postTestTool.getPath(oSendType.pub,pathSpringMothod.postTest.bodyString),										
	"bodyEntity":postTestTool.getPath(oSendType.pub,pathSpringMothod.postTest.bodyEntity),										
	"bodyMap":postTestTool.getPath(oSendType.pub,pathSpringMothod.postTest.bodyMap),										
	"objectRequest":postTestTool.getPath(oSendType.pub,pathSpringMothod.postTest.objectRequest),										
	},										
	"exp":{										
	"noBody":postTestTool.getPath(oSendType.exp,pathSpringMothod.postTest.nobody),										
	"bodyString":postTestTool.getPath(oSendType.exp,pathSpringMothod.postTest.bodyString),										
	"bodyEntity":postTestTool.getPath(oSendType.exp,pathSpringMothod.postTest.bodyEntity),										
	"bodyMap":postTestTool.getPath(oSendType.exp,pathSpringMothod.postTest.bodyMap),										
	"objectRequest":postTestTool.getPath(oSendType.exp,pathSpringMothod.postTest.objectRequest),										
	},										
	"mid":{										
	"noBody":postTestTool.getPath(oSendType.mid,pathSpringMothod.postTest.nobody),										
	"bodyString":postTestTool.getPath(oSendType.mid,pathSpringMothod.postTest.bodyString),										
	"bodyEntity":postTestTool.getPath(oSendType.mid,pathSpringMothod.postTest.bodyEntity),										
	"bodyMap":postTestTool.getPath(oSendType.mid,pathSpringMothod.postTest.bodyMap),										
	"objectRequest":postTestTool.getPath(oSendType.mid,pathSpringMothod.postTest.objectRequest),										
	} 										
	}										
	/** 最终导出的对象*/										
	var myConfig = 										
	{ 										
	"predixPub":predixPub,										
	"globalValue":globalValue,										
	"predixMyEnv":predixMyEnv, 										
	"assetEnv":assetEnv,										
	"timesEnv":timesEnv,										
	"simulatorEnv":simulatorEnv,										
	"postTestEnv":postTestEnv,										
	"initUrl":{										
	"asset":"/mock-api/predix-asset/asset/group",										
	"times":"/mock-api/predix-asset/asset/hui-times",										
	"postTest":"/mock-api/predix-asset/asset/hui-post-test",										
	"simulator":"/mock-api/predix-asset/asset/hui-simulator"										
	},										
	"windServiceURL":windServiceURL,										
	"simulatorServerURL":simulatorServerURL										
	}										
											
	module.exports = myConfig;										


